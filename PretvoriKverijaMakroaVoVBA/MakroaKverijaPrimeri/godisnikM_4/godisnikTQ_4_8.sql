INSERT INTO Tgodisnik_4 ( GOD, sort, NAZIV, RBR, MATBR, EVS, POL, pol_naziv, KOL1, KOL1A, KOL2, KOL3, KOL4, KOL5, KOL6, KOL7, KOL8, KOL9 )
SELECT TabelaVnes.GOD, [GODISNIK] & [IDX] AS sort, TabelaAdresar.NAZIV, TabelaAdresar.RBR, TabelaAdresar.MATBR, TabelaAdresar.EVS, "" AS POL, "SE" AS pol_naziv, Count(TabelaVnes.POL) AS KOL1, Sum(IIf([drzhava]="807",1,0)) AS KOL1A, Sum(IIf([drzhava]="807" And [narodnost]="01",1,0)) AS KOL2, Sum(IIf([drzhava]="807" And [narodnost]="03",1,0)) AS KOL3, Sum(IIf([drzhava]="807" And [narodnost]="06",1,0)) AS KOL4, Sum(IIf([drzhava]="807" And [narodnost]="05",1,0)) AS KOL5, Sum(IIf([drzhava]="807" And [narodnost]="04",1,0)) AS KOL6, Sum(IIf([drzhava]="807" And [narodnost]="27",1,0)) AS KOL7, Sum(IIf([drzhava]="807" And ([narodnost]<>"01" And [narodnost]<>"03" And [narodnost]<>"06" And [narodnost]<>"04" And [narodnost]<>"05" And [narodnost]<>"27"),1,0)) AS KOL8, Sum(IIf([drzhava]<>"807",1,0)) AS KOL9
FROM TabelaVnes INNER JOIN TabelaAdresar ON (TabelaVnes.OTSEK = TabelaAdresar.SIFRAOTSEK) AND (TabelaVnes.EVS = TabelaAdresar.EVS) AND (TabelaVnes.MATBR = TabelaAdresar.MATBR)
GROUP BY TabelaVnes.GOD, [GODISNIK] & [IDX], TabelaAdresar.NAZIV, TabelaAdresar.RBR, TabelaAdresar.MATBR, TabelaAdresar.EVS, "", "SE";

