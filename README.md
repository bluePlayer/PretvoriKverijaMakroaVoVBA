# PretvoriKverijaMakroaVoVBA
Претвара листа на кверија во текст фајлови во VBA *.bas фајл кој потоа може да се користи во Акцес или Ексел како таков

Се извезуваат кверијата од Акцес фајл во некоја папка со користење на Utils.ExportQuerySQL(pateka). 
Потоа се местат папките и табелите за тоа каде да ги најде кверијата и кои имиња на табели да ги замени со кои, 
наведени во тагот iminjaTabeli одвоени со „цевка“ (|) во PretvoriKverijaVoVBA.exe.config

Функцијата Utils.IzveziKverijaIMakroaVoModuli(pateka) е експериментална. Ги извезува кверијата во соодветни папки со 
името на макрото во кое кверијата се повикуваат, во Акцес фајлот. Ова би значело дека во секоја од овие папки ќе треба 
да се мести нова конфигурација на претворачот, но во случај едно макро да има 30+ кверија, помага во прегледност.  

# Чекор 1 - Намести конфигурација
Во фајлот PretvoriKverijaMakroaVoVBA.exe.config.xml се местат поставки за како сакаме да се изврши извезувањето.
## VID_NA_FAJL
При извезување на кверијата од Акцес во фајлови, каков вид на фајл сакаме да биде. Основна вредност, \*.sql. Може да биде и \*.txt
## IME_NA_IZVEZEN_FAJL
Како сакаме да се вика фајлот на модулот што треба да се створи од самите кверија. Пример: IT1_soopstenie.bas ќе биде ВБА модул кој ќе содржи ВБА функции кои како исход враќаат „Access Jet SQL“ кверија како текст. Во суштина постоечките кверија во Акцес ги автоматизираме да бидат со динамички Ескуел код при што само имињата на табелите по потреба се менуваат, а кверито се створува во лет. 
## IME_NA_IZVEZEN_EKSEL_FAJL
Акцес наредбата DoCmd.RunSQL работи само со акциони кверија, односно кверија кои менуваат податоци (UPDATE), внесуваат податоци во табела (INSERT/SELECT INTO), бришат податоци од табела (DELETE). Кверија кои само листаат податоци нема да се извршат. За ова ќе треба да се користи класата QueryDef. Но исто така DoCmd.RunSQL работи и со извезување податоци во Ексел документ. Така SELECT може да се користи со INTO каде со посебен код се кажува во кој Ексел документ да се извезе исходот од кверито. Пример: imeXLSFajl.xls 
## dodajZaIzvozVoEksel
Во главно сите кверија би можеле да се прилагодат да го извезуваат исходот во Ексел документ. Ова поле служи за тоа, дали при створување на ВБА модул со динамички Ескуел код од кверијата, да се додаде делот во кверито за извезување во Ексел. Дадени кверија веќе содржат INTO збор, па треба да се прегледаат дали ќе треба во Ексел или само во локална табела во Акцес. 
## PATEKA_IZVEZEN_EKSEL_FAJl
Патека каде сакаме Ексел документот да се створи со податоци од кверијата. 
## SQL_KVERIJA_PAPKA
Патека каде се наоѓаат кверијата извезени како текст фајл. 
## VBA_MAKROA_PAPKA
Патека каде се наоѓаат макроата извезени како текст фајл.
## VBA_MAKRO_VID_FAJL
Вид на фајл на модулот кој се добива како исход од претврање на кверијата во динамички Ескуел код. Обично е \*.bas, но може да биде и \*.vb.
## iminijaTabeli
За да може да се користи претворачот треба да постојат текстуални кверија. Акцес има сопствена функционалност која со
малку автоматизирање може да ги извезе сите кверија во текст фајл. За таа цел се користи функцијата Utils.ExportQuerySQL()
од ВБА модулот Utils.bas. 
Потребно е да се најдат сите табели кои се повикуваат во кверијата и соодветно да се наведе нивна замена во новиот модул кој
ќе се створи со претворачот. Тоа се прави во фајлот PretvoriKverijaMakroaVoVBA.exe.config.xml во тагот
iminijaTabeli. Пример:
```xml
	<setting name="iminijaTabeli" serializeAs="Xml">
                <value>
                    <ArrayOfString xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                        xmlns:xsd="http://www.w3.org/2001/XMLSchema">
                        <string>Q_M10|TabelaKveriM10</string>
                        <string>Q_M1|TabelaKveriM1</string>
                        <string>Q_M2|TabelaKveriM2</string>
                        <string>Q_M3|TabelaKveriM3</string>
                        <string>Q_M4|TabelaKveriM4</string>
                        <string>Q_M5|TabelaKveriM5</string>
                        <string>Q_M6|TabelaKveriM6</string>
                        <string>Q_M7|TabelaKveriM7</string>
                        <string>Q_M8|TabelaKveriM8</string>
                        <string>Q_M9|TabelaKveriM9</string>
                        <string>TabelaVnes|TabelaVnes</string>
                        <string>TabelaVnes2|TabelaVnes</string>
                        <string>TabelaAdresar|TabelaAdresar</string>
                        <string>TabelaAdresar1|TabelaAdresar</string>
                        <string>Tgodisnik_1|TabelaGodishnik</string>
                        <string>Tgodisnik_4|TabelaGodishnik4</string>
                        <string>Tgodisnik_7|TabelaGodishnik7</string>
                        <string>Tpol|TabelaPol</string>
                        <string>RZSVNESI_T_KD_SV50A_2009|TabelaVnesSV50</string>
                    </ArrayOfString>
                </value>
            </setting>
```
Тука TabelaKveriM10 ќе биде заменско име за табелата Q_M10, односно, во модулот ќе стане параметар на функцијата која створува дадено квери. Така името на табелата може да се менува по потреба, и секој пат ќе се створи квери со новото име на табелата, пратено како параметар на функцијата. 
Потребно е да се излистаат сите табели, и нивни замески имиња. Ако едно име се содржи во друго име, да се излиста прво тоа што содржи и други букви. За сега заменувањето на дадени табели ќе се изврши онлку пати колку што има повторувања на име на табела во друго име на табела. Ова е дефект. Ќе додадат неколку пати истите имиња на табели како параметар на функциите во модулот. Така ќе треба рачно да се поправи и да се избришат дупликат параметрите. 
Претворачот ќе работи и доколку не се наведат имиња на табели, но тие нема да бидат заменливи.  